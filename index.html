<!DOCTYPE html>
<html lang="en" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="index.css" />
    <title>ØªÙ‡Ø§Ù†ÙŠ Ø¨Ø§Ù„ØªØ®Ø±Ø¬</title>
  </head>
  <body>
    <audio id="partySound" src="preview2.mp3" preload="auto"></audio>
    <audio id="celebrationSound" src="preview.mp3" preload="auto"></audio>
    <div class="container">
      <!-- ØµÙˆØª Ø§Ù„Ø§Ø­ØªÙØ§Ù„ ÙÙ‚Ø· Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© -->

      <div class="content">
        <header class="header">
          <div class="content-header">
            <h1>ğŸ“Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙƒÙ… ÙÙŠ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨ØªÙ‡Ù†Ø¦ØªÙŠ Ø¨ØªØ®Ø±Ø¬ÙŠğŸ“</h1>
            <div class="button">
              <button id="share" onclick="copyLink()">
                ğŸ“¤ Ø´Ø§Ø±Ùƒ Ø±Ø§Ø¨Ø· Ø§Ù„ØªÙ‡Ù†Ø¦Ø©
              </button>
              <button id="change">ğŸŒ“ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</button>
            </div>
            <h2>ğŸ‘‡ Ø¨ØµÙ…ØªÙƒ Ù‡Ù†Ø§ ØªØ¹Ù†ÙŠ Ù„ÙŠ Ø§Ù„ÙƒØ«ÙŠØ±</h2>
          </div>
        </header>
        <nav>
          <form dir="rtl" autocomplete="off">
            <h2>âœï¸ Ø£Ø±Ø³Ù„ ØªÙ‡Ù†Ø¦ØªÙƒ</h2>
            <input type="text" id="name" />
            <label for="name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ±ÙŠÙ…</label>
            <textarea id="text"></textarea>
            <label for="text">Ø§ÙƒØªØ¨ ØªÙ‡Ù†Ø¦ØªÙƒ Ø¨Ø´ÙƒÙ„ Ø®Ø§ØµÙ‡ Ù‡Ù†Ø§</label>
            <div class="button">
              <button type="submit" id="send">Ø§Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‡Ù†Ø¦Ø©</button>
              <button id="ohh">Ø§Ø­ØªÙØ§Ù„ğŸ‰</button>
            </div>
            <div class="count">
              <span id="count2">Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‡Ø§Ù†Ø¦ :</span>
            </div>
          </form>
        </nav>
      </div>
    </div>

    <script src="index.js"></script>
    <!-- ÙƒÙˆØ¯ Ø§Ù„Ø§Ø­ØªÙØ§Ù„ÙŠÙ‡ -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCPMITfeEXS-_JAd9Hc8bp3gYbsuCfYHgo",
        authDomain: "graduation-congrats.firebaseapp.com",
        projectId: "graduation-congrats",
        storageBucket: "graduation-congrats.appspot.com",
        messagingSenderId: "464860244122",
        appId: "1:464860244122:web:f62b82732c3f8d531ed723",
        measurementId: "G-RT7BS0QEQ0",
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      const form = document.querySelector("form");
      const nameInput = document.getElementById("name");
      const messageInput = document.getElementById("text");
      const partySound = document.getElementById("partySound");

      const count2 = document.getElementById("count2");

      async function getCongratsCount() {
        try {
          const snapshot = await db.collection("congratulations").get();
          count2.textContent = `Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‡Ø§Ù†ÙŠ: ${snapshot.size}`;
        } catch (e) {
          console.error("Ø®Ø·Ø£ Ø¨Ø¬Ù„Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‡Ø§Ù†ÙŠ:", e);
        }
      }
      getCongratsCount();

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const name = nameInput.value.trim();
        const message = messageInput.value.trim();

        if (!name || !message) {
          alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ØªÙ‡Ù†Ø¦Ø©");
          return;
        }

        try {
          await db.collection("congratulations").add({
            name,
            message,
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          });

          alert("ğŸ‰ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‡Ù†Ø¦Ø© Ø¨Ù†Ø¬Ø§Ø­");
          form.reset();
          getCongratsCount();

          partySound.play();

          // Ø¥Ø¸Ù‡Ø§Ø± ØªØ£Ø«ÙŠØ± Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ
          confetti({
            particleCount: 150,
            spread: 70,
            origin: { y: 0.6 },
          });
        } catch (error) {
          alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + error.message);
        }
      });
    </script>
  </body>
</html>
